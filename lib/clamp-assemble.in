#!/bin/bash
# clamp-assemble kernel-bitcode kernel-object

if [ "$#" -ne 2 ]; then
  echo "Usage: $0 kernel-bitcode object" >&2
  exit 1
fi

if [ -f $2 ]; then
  mv $2 $2.host.o
  /home/whchung/cppamp/build_release/lib/clamp-embed $1 $2.kernel.o
  ld -r $2.kernel.o $2.host.o -o $2
  rm $2.kernel.o $2.host.o
else
  /home/whchung/cppamp/build_release/lib/clamp-embed $1 $2
fi

